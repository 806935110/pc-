"use strict";require(["config"],function(){require(["jquery","template","load","carousel"],function(s,t){s.cookie.json=!0;var u=s.cookie("products")||[];0===u.length?(s(".ss").css("display","none"),s(".kong").css("display","block"),s("#hj").text(0)):(s(".ss").css("display","block"),s(".kong").css("display","none"));var e=u[0];s(".id").text(e.id),s(".img").children("img").attr("src",e.img),s(".title").text(e.title),s(".price").text(e.price),s(".sub").text(e.sub),s(".amount").text(e.amount);var i="";u.forEach(function(t){i+='<div class="header">\n\t\t\t\t\t\t<div class="id" style="display:none;">'+t.id+'</div>\n\t\t\t\t\t\t<div class="quanxuan"><input type="checkbox" name="" class="xz"></div>\n\t\t\t\t\t\t<div class="img"><img src="'+t.img+'"></div>\n\t\t\t\t\t\t<div class="title" title="'+t.title+'">'+t.title+'</div>\n\t\t\t\t\t\t<div class="price">'+t.price+'</div>\n\t\t\t\t\t\t<div class="amount"><span class="minus">-</span><input type="text" class="amount_input" value="'+t.amount+'"><span class="add">+</span></div>\n\t\t\t\t\t\t<div class="sub">'+(t.price*t.amount).toFixed(2)+'</div>\n\t\t\t\t\t\t<div class="oper"><a href="javascript:void(0);" class="del">删除</a></div>\n\t\t\t\t\t</div>'}),s(".cart").html(i),s(".cart").delegate(".oper","click",function(){for(var t=Number(s(this).parent(".header").children(".id").text()),e=0,i=u.length;e<i;e++)if(u[e].id==t){location.reload(),u.splice(e,1),s(this).parent(".header").remove(),s.cookie("products",u,{path:"/"}),s("#jianshu").text(u.length);for(var n=s.cookie("products"),r=0,a=0,o=n.length;a<o;a++){(r+=Number(n[a].price*n[a].amount)).toFixed(2);return void s("#hj").text(r)}return}}),s(".amount").delegate(".add","click",function(){for(var t=Number(s(this).parents(".header").children(".id").text()),e=Number(s(this).parents(".header").children(".amount").children(".amount_input").val()),i=0,n=u.length;i<n;i++)if(u[i].id==t){u[i].amount++,s.cookie("products",u,{path:"/"}),s(this).parents(".header").children(".amount").children(".amount_input").val(e+1),s(this).parents(".header").children(".sub").text((u[i].amount*u[i].price).toFixed(2)),s("#jianshu").text(u.length);for(var r=s.cookie("products"),a=0,o=0,c=r.length;o<c;o++){(a+=Number(r[o].price*r[o].amount)).toFixed(2);return void s("#hj").text(a)}return}}),s(".amount").delegate(".minus","click",function(){for(var t=Number(s(this).parents(".header").children(".id").text()),e=Number(s(this).parents(".header").children(".amount").children(".amount_input").val()),i=0,n=u.length;i<n;i++)if(u[i].id==t&&1<u[i].amount){u[i].amount--,s.cookie("products",u,{path:"/"}),s(this).parents(".header").children(".amount").children(".amount_input").val(e-1),s(this).parents(".header").children(".sub").text((u[i].amount*u[i].price).toFixed(2)),s("#jianshu").text(u.length);for(var r=s.cookie("products"),a=0,o=0,c=r.length;o<c;o++){(a+=Number(r[o].price*r[o].amount)).toFixed(2);return void s("#hj").text(a)}return}}),s(".amount").delegate(".amount_input","blur",function(){for(var t=Number(s(this).parents(".header").children(".id").text()),e=Number(s(this).parents(".header").children(".amount").children(".amount_input").val()),i=0,n=u.length;i<n;i++)if(u[i].id==t){var r=u[i].amount;if(1<=e){u[i].amount=e,s.cookie("products",u,{path:"/"}),s(this).parents(".header").children(".sub").text((u[i].amount*u[i].price).toFixed(2)),s("#jianshu").text(u.length);for(var a=s.cookie("products"),o=0,c=0,d=a.length;c<d;c++){(o+=Number(a[c].price*a[c].amount)).toFixed(2);return void s("#hj").text(o)}return}s.cookie("products",u,{path:"/"}),s(this).parents(".header").children(".amount").children(".amount_input").val(r),s(this).parents(".header").children(".sub").text((u[i].amount*u[i].price).toFixed(2))}}),s("#jianshu").text(u.length);for(var n=s.cookie("products"),r=0,a=0,o=n.length;a<o;a++){(r+=Number(n[a].price*n[a].amount)).toFixed(2);s("#hj").text(r)}function c(){var t=0;s(".xz:checked").each(function(){t+=Number(s(this).parents(".header").children(".sub").text())}),s(".c > p>span").text(t)}s(".qx").click(function(){var t=s(this).prop("checked");s(".xz").prop("checked",t),s(".qx").prop("checked",t),c()}),s(".cart").on("click",".xz",function(){s(".qx").prop("checked",s(".xz:checked").length===u.length),c()})})});